<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>n8n Installation Guide — Arrissa Data</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <style>
        :root {
            --bg-primary: #0f0f0f;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #2d2d2d;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --accent: #4f46e5;
            --accent-hover: #6366f1;
            --border: #3a3a3a;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --card-bg: #1f1f1f;
            --input-bg: #262626;
            --input-border: #404040;
        }
        * { box-sizing: border-box; scrollbar-width: thin; scrollbar-color: var(--input-border) var(--bg-secondary); }
        *::-webkit-scrollbar { width: 6px; height: 6px; }
        *::-webkit-scrollbar-track { background: var(--bg-secondary); }
        *::-webkit-scrollbar-thumb { background-color: var(--input-border); border-radius: 3px; }
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; background-color: var(--bg-primary); color: var(--text-primary); margin: 0; line-height: 1.6; }
        a { color: var(--accent); text-decoration: none; }
        a:hover { text-decoration: underline; }
        .top-nav { position: sticky; top: 0; z-index: 100; background-color: rgba(15,15,15,0.92); backdrop-filter: blur(10px); border-bottom: 1px solid var(--border); padding: 14px 32px; display: flex; align-items: center; justify-content: space-between; }
        .nav-logo { display: flex; align-items: center; gap: 12px; }
        .nav-logo-n8n { width: 36px; height: 36px; border-radius: 50%; background: linear-gradient(135deg,#ea4b71,#ff6d5a); display: flex; align-items: center; justify-content: center; flex-shrink: 0; font-size: 0.78rem; font-weight: 800; color: #fff; letter-spacing: -0.03em; }
        .nav-links { display: flex; gap: 24px; align-items: center; }
        .nav-links a { color: var(--text-secondary); font-size: 0.875rem; font-weight: 500; transition: color 0.15s; }
        .nav-links a:hover { color: var(--text-primary); text-decoration: none; }
        .back-link { display: inline-flex; align-items: center; gap: 6px; color: var(--text-secondary); font-size: 0.8rem; font-weight: 600; border: 1px solid var(--border); border-radius: 9999px; padding: 6px 14px; transition: all 0.15s; }
        .back-link:hover { border-color: var(--accent); color: var(--text-primary); text-decoration: none; }
        .container { max-width: 900px; margin: 0 auto; padding: 0 24px; }
        .hero { text-align: center; padding: 72px 24px 48px; }
        .hero h1 { font-size: 2.5rem; font-weight: 800; letter-spacing: -0.03em; margin: 0 0 16px; }
        .hero p { color: var(--text-secondary); font-size: 1.1rem; max-width: 580px; margin: 0 auto; }
        .n8n-logo-big { width: 72px; height: 72px; border-radius: 24px; background: linear-gradient(135deg,#ea4b71,#ff6d5a); display: flex; align-items: center; justify-content: center; margin: 0 auto 24px; font-size: 1.4rem; font-weight: 900; color: #fff; letter-spacing: -0.04em; }
        .configurator { background-color: var(--card-bg); border: 1px solid var(--border); border-radius: 24px; padding: 32px; margin-bottom: 48px; }
        .config-title { font-size: 1rem; font-weight: 700; margin: 0 0 20px; color: var(--text-primary); }
        .config-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; margin-bottom: 24px; }
        @media (max-width: 700px) { .config-grid { grid-template-columns: 1fr; } }
        @media (max-width: 900px) and (min-width: 701px) { .config-grid { grid-template-columns: 1fr 1fr; } }
        label.field-label { display: block; font-size: 0.78rem; font-weight: 600; color: var(--text-secondary); margin-bottom: 8px; }
        input.text-field { width: 100%; background-color: var(--input-bg); border: 1px solid var(--input-border); border-radius: 9999px; padding: 10px 16px; font-size: 0.875rem; color: var(--text-primary); font-family: inherit; outline: none; transition: border-color 0.15s; }
        input.text-field:focus { border-color: var(--accent); }
        .env-tabs { display: flex; gap: 8px; flex-wrap: wrap; }
        .env-tab { padding: 10px 20px; border-radius: 9999px; border: 1px solid var(--border); background: transparent; color: var(--text-secondary); font-size: 0.875rem; font-weight: 600; cursor: pointer; transition: all 0.2s; font-family: inherit; }
        .env-tab:hover { border-color: var(--accent); color: var(--text-primary); }
        .env-tab.active { background-color: var(--accent); border-color: var(--accent); color: #fff; }
        .section { margin-bottom: 64px; }
        .section-header { display: flex; align-items: center; gap: 14px; margin-bottom: 28px; }
        .section-icon { width: 48px; height: 48px; border-radius: 16px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .section-header h2 { font-size: 1.5rem; font-weight: 700; margin: 0 0 4px; }
        .section-header p { font-size: 0.875rem; color: var(--text-secondary); margin: 0; }
        .steps { display: flex; flex-direction: column; gap: 20px; }
        .step { background-color: var(--card-bg); border: 1px solid var(--border); border-radius: 20px; padding: 24px; }
        .step-num { display: inline-flex; align-items: center; justify-content: center; width: 28px; height: 28px; border-radius: 50%; background-color: var(--accent); color: #fff; font-size: 0.75rem; font-weight: 700; margin-right: 10px; flex-shrink: 0; }
        .step-title { font-size: 1rem; font-weight: 700; color: var(--text-primary); display: flex; align-items: center; margin-bottom: 12px; }
        .step-body { font-size: 0.875rem; color: var(--text-secondary); }
        .step-body p { margin: 0 0 12px; }
        .step-body p:last-child { margin-bottom: 0; }
        .code-block { position: relative; background-color: #0d0d0d; border: 1px solid var(--input-border); border-radius: 14px; margin: 12px 0; overflow: hidden; }
        .code-block pre { margin: 0; padding: 16px 50px 16px 16px; font-family: 'JetBrains Mono', 'Fira Code', 'Courier New', monospace; font-size: 0.8rem; color: #e2e8f0; overflow-x: auto; white-space: pre; }
        .code-lang { position: absolute; top: 10px; left: 14px; font-size: 0.65rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; }
        .copy-btn { position: absolute; top: 8px; right: 10px; background-color: var(--bg-tertiary); border: 1px solid var(--border); color: var(--text-secondary); border-radius: 8px; padding: 5px 10px; font-size: 0.7rem; cursor: pointer; font-family: inherit; font-weight: 600; transition: all 0.15s; display: flex; align-items: center; gap: 4px; }
        .copy-btn:hover { background-color: var(--accent); color: #fff; border-color: var(--accent); }
        .copy-btn.copied { background-color: var(--success); color: #fff; border-color: var(--success); }
        .callout { border-radius: 14px; padding: 14px 16px; margin: 12px 0; display: flex; align-items: flex-start; gap: 12px; font-size: 0.85rem; }
        .callout-info { background-color: rgba(79,70,229,0.1); border: 1px solid rgba(79,70,229,0.3); color: var(--text-secondary); }
        .callout-warn { background-color: rgba(245,158,11,0.1); border: 1px solid rgba(245,158,11,0.35); color: var(--text-secondary); }
        .callout-success { background-color: rgba(16,185,129,0.1); border: 1px solid rgba(16,185,129,0.3); color: var(--text-secondary); }
        .callout-icon { flex-shrink: 0; margin-top: 1px; }
        .badge { display: inline-flex; align-items: center; gap: 4px; padding: 3px 10px; border-radius: 9999px; font-size: 0.7rem; font-weight: 700; letter-spacing: 0.04em; text-transform: uppercase; }
        .badge-accent { background-color: rgba(79,70,229,0.15); color: var(--accent); border: 1px solid rgba(79,70,229,0.3); }
        .badge-n8n { background: linear-gradient(90deg,rgba(234,75,113,0.15),rgba(255,109,90,0.15)); color: #ff6d5a; border: 1px solid rgba(255,109,90,0.35); }
        .badge-success { background-color: rgba(16,185,129,0.15); color: var(--success); border: 1px solid rgba(16,185,129,0.3); }
        .badge-warn { background-color: rgba(245,158,11,0.12); color: var(--warning); border: 1px solid rgba(245,158,11,0.3); }
        .divider { height: 1px; background: linear-gradient(90deg, transparent, var(--border), transparent); margin: 48px 0; }
        .page-layout { display: flex; gap: 40px; align-items: flex-start; }
        .toc { width: 220px; flex-shrink: 0; position: sticky; top: 72px; background-color: var(--card-bg); border: 1px solid var(--border); border-radius: 16px; padding: 20px; font-size: 0.8rem; }
        .toc-title { font-weight: 700; color: var(--text-primary); margin-bottom: 12px; font-size: 0.82rem; }
        .toc a { display: block; color: var(--text-secondary); padding: 5px 0; transition: color 0.15s; }
        .toc a:hover { color: var(--text-primary); text-decoration: none; }
        .main-content { flex: 1; min-width: 0; }
        @media (max-width: 768px) { .toc { display: none; } }
        code { background-color: var(--bg-tertiary); padding: 2px 7px; border-radius: 5px; font-size: 0.82em; font-family: monospace; color: #c4b5fd; }
        footer { border-top: 1px solid var(--border); padding: 32px 24px; text-align: center; color: var(--text-secondary); font-size: 0.8rem; margin-top: 64px; }
        .env-panel { display: none; }
        .env-panel.active { display: block; }
        .hl-domain { color: #a5f3fc; }
        .hl-ip { color: #fde68a; }
        .hl-user { color: #86efac; }
        /* Related guides card */
        .guide-card { background-color: var(--card-bg); border: 1px solid var(--border); border-radius: 20px; padding: 24px; display: flex; align-items: center; gap: 20px; text-decoration: none; transition: border-color 0.2s, transform 0.15s; }
        .guide-card:hover { border-color: var(--accent); transform: translateY(-2px); text-decoration: none; }
        .guide-card-icon { width: 48px; height: 48px; border-radius: 14px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .guide-card-text h3 { font-size: 1rem; font-weight: 700; color: var(--text-primary); margin: 0 0 4px; }
        .guide-card-text p { font-size: 0.82rem; color: var(--text-secondary); margin: 0; }
    </style>
</head>
<body>

<!-- Top Nav -->
<nav class="top-nav">
    <div class="nav-logo">
        <div class="nav-logo-n8n">n8n</div>
        <span style="font-weight:700;font-size:1rem;">n8n</span>
        <span class="badge badge-n8n" style="margin-left:4px;">Install Guide</span>
    </div>
    <div class="nav-links">
        <a href="#configure">Configure</a>
        <a href="#post-install">Post-Install</a>
        <a href="/get/brokers.html"" class="back-link">
            <i data-feather="trending-up" style="width:13px;height:13px;"></i> Brokers
        </a>
        <a href="/get/vps-providers.html"" class="back-link">
            <i data-feather="cloud" style="width:13px;height:13px;"></i> VPS
        </a>
        <a href="/get/"" class="back-link">
            <i data-feather="arrow-left" style="width:13px;height:13px;"></i> API Guide
        </a>
    </div>
</nav>

<!-- Hero -->
<div class="hero container">
    <div class="n8n-logo-big">n8n</div>
    <h1>n8n Installation Guide</h1>
    <p>Set up n8n workflow automation on Ubuntu VPS with Caddy, or locally on Windows / macOS using Docker. Commands personalised to your setup.</p>
</div>

<div class="container">

    <!-- Configurator -->
    <div class="configurator" id="configure">
        <p class="config-title"><i data-feather="settings" style="width:16px;height:16px;display:inline;vertical-align:-3px;margin-right:6px;color:#ff6d5a;"></i>Quick Configurator — fill in your details for personalised commands</p>
        <div class="config-grid">
            <div>
                <label class="field-label" for="domainInput">Domain / Subdomain</label>
                <input class="text-field" type="text" id="domainInput" placeholder="e.g. n8n.yourdomain.com" oninput="updateAll()">
            </div>
            <div>
                <label class="field-label" for="ipInput">Server IP Address</label>
                <input class="text-field" type="text" id="ipInput" placeholder="e.g. 203.0.113.10" oninput="updateAll()">
            </div>
            <div>
                <label class="field-label" for="userInput">VPS Username</label>
                <input class="text-field" type="text" id="userInput" placeholder="e.g. ubuntu" oninput="updateAll()">
            </div>
        </div>
        <div class="callout callout-info" style="margin-bottom:20px;">
            <i data-feather="info" class="callout-icon" style="width:16px;height:16px;color:var(--accent);"></i>
            <span>Domain and IP are only needed for the Ubuntu VPS setup. Local installs (Windows / macOS) use <code>localhost:5678</code> — no domain required.</span>
        </div>
        <label class="field-label">Choose Your Environment</label>
        <div class="env-tabs">
            <button class="env-tab active" onclick="switchEnv('ubuntu')">
                <i data-feather="server" style="width:14px;height:14px;display:inline;vertical-align:-2px;margin-right:6px;"></i>Ubuntu VPS + Caddy
            </button>
            <button class="env-tab" onclick="switchEnv('windows')">
                <i data-feather="monitor" style="width:14px;height:14px;display:inline;vertical-align:-2px;margin-right:6px;"></i>Windows + Docker
            </button>
            <button class="env-tab" onclick="switchEnv('mac')">
                <i data-feather="terminal" style="width:14px;height:14px;display:inline;vertical-align:-2px;margin-right:6px;"></i>macOS + Docker
            </button>
        </div>
    </div>

    <div class="page-layout">
        <aside class="toc">
            <div class="toc-title">On This Page</div>
            <a href="#prerequisites">Prerequisites</a>
            <a href="#docker-install">Install Docker</a>
            <a href="#n8n-setup">n8n Setup</a>
            <a href="#caddy-setup">Caddy Config</a>
            <a href="#first-run">First Run</a>
            <a href="#post-install">Post-Install</a>
            <a href="#updating">Updating n8n</a>
            <a href="#troubleshooting">Troubleshooting</a>
            <a href="#related">Related Guides</a>
        </aside>

        <div class="main-content">

<!-- ══════════════════════════════════ UBUNTU VPS + CADDY -->
<div class="env-panel active" id="panel-ubuntu">

    <div class="section" id="prerequisites">
        <div class="section-header">
            <div class="section-icon" style="background:linear-gradient(135deg,#4f46e5,#6366f1);">
                <i data-feather="check-square" style="width:22px;height:22px;color:#fff;"></i>
            </div>
            <div>
                <h2>Prerequisites <span class="badge badge-accent">Ubuntu VPS + Caddy</span></h2>
                <p>What you need before starting</p>
            </div>
        </div>
        <div class="steps">
            <div class="step">
                <div class="step-title"><span class="step-num">1</span>Requirements</div>
                <div class="step-body">
                    <ul style="margin:0 0 0 16px;padding:0;list-style:disc;line-height:2.2;">
                        <li>Ubuntu 22.04 LTS or 24.04</li>
                        <li>Minimum 1 GB RAM (2 GB recommended)</li>
                        <li>Domain or subdomain with an <strong style="color:var(--text-primary);">A record</strong> pointing to your server IP — e.g. <code class="hl-domain" id="u-domain-txt">n8n.yourdomain.com</code> → <code class="hl-ip" id="u-ip-txt">YOUR_IP</code></li>
                        <li>Root or sudo access</li>
                        <li>Ports 80, 443 open in your firewall</li>
                    </ul>
                </div>
            </div>
            <div class="step">
                <div class="step-title"><span class="step-num">2</span>SSH into your server</div>
                <div class="step-body">
                    <div class="code-block">
                        <span class="code-lang">bash</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                        <pre id="u-ssh">ssh ubuntu@YOUR_SERVER_IP</pre>
                    </div>
                    <p>All commands below are run on the server after SSH-ing in.</p>
                </div>
            </div>
            <div class="step">
                <div class="step-title"><span class="step-num">3</span>Update system packages</div>
                <div class="step-body">
                    <div class="code-block">
                        <span class="code-lang">bash</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                        <pre>sudo apt update && sudo apt upgrade -y
sudo apt install -y curl ca-certificates</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="divider"></div>

    <div class="section" id="docker-install">
        <div class="section-header">
            <div class="section-icon" style="background:linear-gradient(135deg,#0ea5e9,#2563eb);">
                <i data-feather="package" style="width:22px;height:22px;color:#fff;"></i>
            </div>
            <div>
                <h2>Install Docker</h2>
                <p>n8n runs in a Docker container</p>
            </div>
        </div>
        <div class="steps">
            <div class="step">
                <div class="step-title"><span class="step-num">1</span>Install Docker Engine</div>
                <div class="step-body">
                    <div class="code-block">
                        <span class="code-lang">bash</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                        <pre>curl -fsSL https://get.docker.com | sudo sh
sudo usermod -aG docker $USER</pre>
                    </div>
                    <div class="callout callout-warn">
                        <i data-feather="alert-triangle" class="callout-icon" style="width:16px;height:16px;color:var(--warning);"></i>
                        <span>After running <code>usermod</code>, log out and back in (or run <code>newgrp docker</code>) so the group change takes effect.</span>
                    </div>
                </div>
            </div>
            <div class="step">
                <div class="step-title"><span class="step-num">2</span>Verify Docker is running</div>
                <div class="step-body">
                    <div class="code-block">
                        <span class="code-lang">bash</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                        <pre>docker --version
sudo systemctl enable docker
sudo systemctl start docker</pre>
                    </div>
                </div>
            </div>
            <div class="step">
                <div class="step-title"><span class="step-num">3</span>Install Caddy</div>
                <div class="step-body">
                    <div class="code-block">
                        <span class="code-lang">bash</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                        <pre>sudo apt install -y debian-keyring debian-archive-keyring apt-transport-https
curl -1sLf 'https://dl.cloudsmith.io/public/caddy/stable/gpg.key' | sudo gpg --dearmor -o /usr/share/keyrings/caddy-stable-archive-keyring.gpg
curl -1sLf 'https://dl.cloudsmith.io/public/caddy/stable/debian.deb.txt' | sudo tee /etc/apt/sources.list.d/caddy-stable.list
sudo apt update && sudo apt install -y caddy</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="divider"></div>

    <div class="section" id="n8n-setup">
        <div class="section-header">
            <div class="section-icon" style="background:linear-gradient(135deg,#ea4b71,#ff6d5a);">
                <i data-feather="zap" style="width:22px;height:22px;color:#fff;"></i>
            </div>
            <div>
                <h2>Set Up n8n</h2>
                <p>Create the Docker Compose config and start n8n</p>
            </div>
        </div>
        <div class="steps">
            <div class="step">
                <div class="step-title"><span class="step-num">1</span>Create the n8n directory</div>
                <div class="step-body">
                    <div class="code-block">
                        <span class="code-lang">bash</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                        <pre>sudo mkdir -p /opt/n8n
sudo chown $USER:$USER /opt/n8n
cd /opt/n8n</pre>
                    </div>
                </div>
            </div>
            <div class="step">
                <div class="step-title"><span class="step-num">2</span>Create the Docker Compose file</div>
                <div class="step-body">
                    <p>This writes the file without an editor:</p>
                    <div class="code-block">
                        <span class="code-lang">bash</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                        <pre id="u-compose">tee /opt/n8n/docker-compose.yml &lt;&lt;'EOF'
services:
  n8n:
    image: docker.n8n.io/n8nio/n8n
    container_name: n8n
    restart: always
    ports:
      - "127.0.0.1:5678:5678"
    environment:
      - N8N_HOST=n8n.yourdomain.com
      - N8N_PORT=5678
      - N8N_PROTOCOL=https
      - WEBHOOK_URL=https://n8n.yourdomain.com/
      - GENERIC_TIMEZONE=UTC
      - N8N_SECURE_COOKIE=true
    volumes:
      - n8n_data:/home/node/.n8n

volumes:
  n8n_data:
EOF</pre>
                    </div>
                    <div class="callout callout-info">
                        <i data-feather="info" class="callout-icon" style="width:16px;height:16px;color:var(--accent);"></i>
                        <span>We bind n8n to <code>127.0.0.1:5678</code> so it's only accessible through Caddy — never directly from the internet.</span>
                    </div>
                </div>
            </div>
            <div class="step">
                <div class="step-title"><span class="step-num">3</span>Start n8n</div>
                <div class="step-body">
                    <div class="code-block">
                        <span class="code-lang">bash</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                        <pre>cd /opt/n8n && docker compose up -d</pre>
                    </div>
                    <p>Check it started correctly:</p>
                    <div class="code-block">
                        <span class="code-lang">bash</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                        <pre>docker compose logs -f n8n</pre>
                    </div>
                    <p>You should see <code>Editor is now accessible via: http://localhost:5678/</code>. Press <kbd>Ctrl+C</kbd> to exit logs.</p>
                </div>
            </div>
        </div>
    </div>

    <div class="divider"></div>

    <div class="section" id="caddy-setup">
        <div class="section-header">
            <div class="section-icon" style="background:linear-gradient(135deg,#10b981,#059669);">
                <i data-feather="shield" style="width:22px;height:22px;color:#fff;"></i>
            </div>
            <div>
                <h2>Configure Caddy (HTTPS)</h2>
                <p>Reverse proxy with automatic Let's Encrypt certificate</p>
            </div>
        </div>
        <div class="steps">
            <div class="step">
                <div class="step-title"><span class="step-num">1</span>Append n8n block to Caddyfile</div>
                <div class="step-body">
                    <div class="callout callout-warn" style="margin-bottom:12px;">
                        <i data-feather="alert-triangle" class="callout-icon" style="width:16px;height:16px;color:var(--warning);"></i>
                        <span><strong>Do not overwrite your Caddyfile.</strong> If you already have Arrissa Data or other apps configured, use <code>tee -a</code> (append) — not plain <code>tee</code> — so existing blocks are preserved.</span>
                    </div>

                    <p class="text-sm font-semibold mb-2" style="color:var(--text-primary);">Option A — No Cloudflare proxy / DNS-only (grey cloud):</p>
                    <p class="text-sm mb-3" style="color:var(--text-secondary);">Caddy auto-obtains a Let's Encrypt certificate directly. Your DNS A record must point straight to this server's IP.</p>
                    <div class="code-block" style="margin-bottom:16px;">
                        <span class="code-lang">bash</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                        <pre id="u-caddy">sudo tee -a /etc/caddy/Caddyfile &lt;&lt;'EOF'

n8n.yourdomain.com {
    reverse_proxy localhost:5678
    encode gzip
    header {
        Strict-Transport-Security "max-age=31536000; includeSubDomains"
        X-Content-Type-Options "nosniff"
        X-Frame-Options "SAMEORIGIN"
    }
}
EOF

# Verify the full Caddyfile looks correct
cat /etc/caddy/Caddyfile</pre>
                    </div>

                    <p class="text-sm font-semibold mb-2" style="color:var(--text-primary);">Option B — Cloudflare proxied (orange cloud):</p>
                    <p class="text-sm mb-3" style="color:var(--text-secondary);">When Cloudflare is proxying, it terminates SSL itself and connects to your origin over HTTPS. Caddy cannot complete a Let's Encrypt HTTP-01 challenge in this mode — use <code>tls internal</code> instead (Caddy issues a self-signed cert that Cloudflare trusts in <strong>Full</strong> mode).</p>
                    <div class="code-block" style="margin-bottom:12px;">
                        <span class="code-lang">bash</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                        <pre>sudo tee -a /etc/caddy/Caddyfile &lt;&lt;'EOF'

n8n.yourdomain.com {
    tls internal
    reverse_proxy localhost:5678
    encode gzip
    header {
        Strict-Transport-Security "max-age=31536000; includeSubDomains"
        X-Content-Type-Options "nosniff"
        X-Frame-Options "SAMEORIGIN"
    }
}
EOF

cat /etc/caddy/Caddyfile</pre>
                    </div>
                    <div class="callout callout-info">
                        <i data-feather="info" class="callout-icon" style="width:16px;height:16px;color:var(--accent);"></i>
                        <span>After adding <code>tls internal</code>, go to <strong>Cloudflare Dashboard → SSL/TLS → Overview</strong> and set the encryption mode to <strong>Full</strong> (not Flexible, not Full Strict). Flexible causes redirect loops; Full Strict requires a CA-signed cert on the origin which <code>tls internal</code> does not provide.</span>
                    </div>

                    <div class="callout callout-info" style="margin-top:8px;">
                        <i data-feather="info" class="callout-icon" style="width:16px;height:16px;color:var(--accent);"></i>
                        <span>The blank line before each site block ensures Caddy parses them cleanly. Run <code>sudo caddy fmt --overwrite /etc/caddy/Caddyfile</code> to auto-format the file.</span>
                    </div>
                </div>
            </div>
            <div class="step">
                <div class="step-title"><span class="step-num">2</span>Reload Caddy</div>
                <div class="step-body">
                    <div class="code-block">
                        <span class="code-lang">bash</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                        <pre>sudo systemctl enable caddy
sudo systemctl reload caddy</pre>
                    </div>
                    <div class="callout callout-warn">
                        <i data-feather="alert-triangle" class="callout-icon" style="width:16px;height:16px;color:var(--warning);"></i>
                        <span><strong>Option A only:</strong> Your domain's DNS A record must point directly to this server's IP (grey cloud in Cloudflare) for Caddy to issue the Let's Encrypt certificate. If using Cloudflare proxy (orange cloud), use Option B with <code>tls internal</code> instead.</span>
                    </div>
                </div>
            </div>
            <div class="step" id="first-run">
                <div class="step-title"><span class="step-num">3</span>Open n8n in your browser</div>
                <div class="step-body">
                    <p>Navigate to <a class="hl-domain" id="u-n8n-url" href="#" target="_blank">https://n8n.yourdomain.com</a></p>
                    <p>n8n will show a setup wizard on first launch — create your owner account and set a password.</p>
                    <div class="callout callout-success">
                        <i data-feather="check-circle" class="callout-icon" style="width:16px;height:16px;color:var(--success);"></i>
                        <span>n8n is now running with HTTPS, persistent storage, and auto-restarts on reboot.</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div><!-- /panel-ubuntu -->

<!-- ══════════════════════════════════ WINDOWS + DOCKER -->
<div class="env-panel" id="panel-windows">

    <div class="section" id="prerequisites">
        <div class="section-header">
            <div class="section-icon" style="background:linear-gradient(135deg,#f59e0b,#ef4444);">
                <i data-feather="monitor" style="width:22px;height:22px;color:#fff;"></i>
            </div>
            <div>
                <h2>Prerequisites <span class="badge badge-warn">Windows + Docker</span></h2>
                <p>Local n8n on your Windows machine — no domain needed</p>
            </div>
        </div>
        <div class="steps">
            <div class="step">
                <div class="step-title"><span class="step-num">1</span>Install Docker Desktop for Windows</div>
                <div class="step-body">
                    <p>Download from <a href="https://www.docker.com/products/docker-desktop/" target="_blank">docker.com/products/docker-desktop</a>.</p>
                    <p>Requirements:</p>
                    <ul style="margin:6px 0 0 16px;list-style:disc;line-height:2.2;">
                        <li>Windows 10/11 (64-bit) with WSL 2 backend enabled</li>
                        <li>Virtualization enabled in BIOS</li>
                        <li>Minimum 4 GB RAM</li>
                    </ul>
                    <div class="callout callout-info" style="margin-top:12px;">
                        <i data-feather="info" class="callout-icon" style="width:16px;height:16px;color:var(--accent);"></i>
                        <span>If asked to install WSL 2 during setup, follow the prompt — it's required. After install, <strong>restart your PC</strong> before continuing.</span>
                    </div>
                </div>
            </div>
            <div class="step">
                <div class="step-title"><span class="step-num">2</span>Verify Docker is running</div>
                <div class="step-body">
                    <p>Open <strong>PowerShell</strong> and run:</p>
                    <div class="code-block">
                        <span class="code-lang">powershell</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                        <pre>docker --version
docker ps</pre>
                    </div>
                    <p>If you see version info and an empty container list, Docker is ready.</p>
                </div>
            </div>
        </div>
    </div>

    <div class="divider"></div>

    <div class="section" id="n8n-setup">
        <div class="section-header">
            <div class="section-icon" style="background:linear-gradient(135deg,#ea4b71,#ff6d5a);">
                <i data-feather="zap" style="width:22px;height:22px;color:#fff;"></i>
            </div>
            <div>
                <h2>Set Up n8n</h2>
                <p>Create a Docker Compose config and run n8n locally</p>
            </div>
        </div>
        <div class="steps">
            <div class="step">
                <div class="step-title"><span class="step-num">1</span>Create an n8n folder and Compose file</div>
                <div class="step-body">
                    <p>Run in <strong>PowerShell</strong>:</p>
                    <div class="code-block">
                        <span class="code-lang">powershell</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                        <pre>New-Item -ItemType Directory -Force -Path "$env:USERPROFILE\n8n"
Set-Location "$env:USERPROFILE\n8n"</pre>
                    </div>
                    <div class="code-block">
                        <span class="code-lang">powershell</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                        <pre>@"
services:
  n8n:
    image: docker.n8n.io/n8nio/n8n
    container_name: n8n
    restart: unless-stopped
    ports:
      - "5678:5678"
    environment:
      - N8N_SECURE_COOKIE=false
      - GENERIC_TIMEZONE=UTC
    volumes:
      - n8n_data:/home/node/.n8n

volumes:
  n8n_data:
"@ | Out-File -FilePath "$env:USERPROFILE\n8n\docker-compose.yml" -Encoding UTF8 -NoNewline</pre>
                    </div>
                </div>
            </div>
            <div class="step" id="first-run">
                <div class="step-title"><span class="step-num">2</span>Start n8n</div>
                <div class="step-body">
                    <div class="code-block">
                        <span class="code-lang">powershell</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                        <pre>Set-Location "$env:USERPROFILE\n8n"
docker compose up -d</pre>
                    </div>
                    <p>Check startup logs:</p>
                    <div class="code-block">
                        <span class="code-lang">powershell</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                        <pre>docker compose logs -f n8n</pre>
                    </div>
                    <div class="callout callout-success">
                        <i data-feather="check-circle" class="callout-icon" style="width:16px;height:16px;color:var(--success);"></i>
                        <span>Open <a href="http://localhost:5678" target="_blank"><strong>http://localhost:5678</strong></a> in your browser. n8n's setup wizard will appear on first launch.</span>
                    </div>
                    <div class="callout callout-info" style="margin-top:0;">
                        <i data-feather="info" class="callout-icon" style="width:16px;height:16px;color:var(--accent);"></i>
                        <span><code>N8N_SECURE_COOKIE=false</code> is required for local HTTP. On a live HTTPS domain set this to <code>true</code> instead.</span>
                    </div>
                </div>
            </div>
            <div class="step">
                <div class="step-title"><span class="step-num">3</span>Start / Stop n8n</div>
                <div class="step-body">
                    <div class="code-block">
                        <span class="code-lang">powershell</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                        <pre># Stop
docker compose -f "$env:USERPROFILE\n8n\docker-compose.yml" down

# Start again
docker compose -f "$env:USERPROFILE\n8n\docker-compose.yml" up -d</pre>
                    </div>
                    <p>Because <code>restart: unless-stopped</code> is set, n8n will start automatically when Docker Desktop starts on boot.</p>
                </div>
            </div>
        </div>
    </div>

</div><!-- /panel-windows -->

<!-- ══════════════════════════════════ macOS + DOCKER -->
<div class="env-panel" id="panel-mac">

    <div class="section" id="prerequisites">
        <div class="section-header">
            <div class="section-icon" style="background:linear-gradient(135deg,#8b5cf6,#6366f1);">
                <i data-feather="terminal" style="width:22px;height:22px;color:#fff;"></i>
            </div>
            <div>
                <h2>Prerequisites <span class="badge badge-accent">macOS + Docker</span></h2>
                <p>Local n8n on your Mac — no domain needed</p>
            </div>
        </div>
        <div class="steps">
            <div class="step">
                <div class="step-title"><span class="step-num">1</span>Install Docker Desktop for Mac</div>
                <div class="step-body">
                    <p><strong>Option A — Download directly:</strong></p>
                    <p>Get the installer from <a href="https://www.docker.com/products/docker-desktop/" target="_blank">docker.com/products/docker-desktop</a>. Choose the correct chip: <strong>Apple Silicon (M1/M2/M3)</strong> or <strong>Intel</strong>.</p>
                    <p><strong>Option B — Install via Homebrew:</strong></p>
                    <div class="code-block">
                        <span class="code-lang">bash</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                        <pre>brew install --cask docker</pre>
                    </div>
                    <div class="callout callout-info">
                        <i data-feather="info" class="callout-icon" style="width:16px;height:16px;color:var(--accent);"></i>
                        <span>After installing, open Docker Desktop from your Applications folder and wait for it to finish starting (the whale icon in the menu bar goes steady).</span>
                    </div>
                </div>
            </div>
            <div class="step">
                <div class="step-title"><span class="step-num">2</span>Verify Docker is running</div>
                <div class="step-body">
                    <p>Open <strong>Terminal</strong> and run:</p>
                    <div class="code-block">
                        <span class="code-lang">bash</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                        <pre>docker --version && docker ps</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="divider"></div>

    <div class="section" id="n8n-setup">
        <div class="section-header">
            <div class="section-icon" style="background:linear-gradient(135deg,#ea4b71,#ff6d5a);">
                <i data-feather="zap" style="width:22px;height:22px;color:#fff;"></i>
            </div>
            <div>
                <h2>Set Up n8n</h2>
                <p>Create the Docker Compose config and run n8n</p>
            </div>
        </div>
        <div class="steps">
            <div class="step">
                <div class="step-title"><span class="step-num">1</span>Create the n8n folder and Compose file</div>
                <div class="step-body">
                    <div class="code-block">
                        <span class="code-lang">bash</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                        <pre>mkdir -p ~/n8n && cd ~/n8n</pre>
                    </div>
                    <div class="code-block">
                        <span class="code-lang">bash</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                        <pre>cat &gt; ~/n8n/docker-compose.yml &lt;&lt;'EOF'
services:
  n8n:
    image: docker.n8n.io/n8nio/n8n
    container_name: n8n
    restart: unless-stopped
    ports:
      - "5678:5678"
    environment:
      - N8N_SECURE_COOKIE=false
      - GENERIC_TIMEZONE=UTC
    volumes:
      - n8n_data:/home/node/.n8n

volumes:
  n8n_data:
EOF</pre>
                    </div>
                </div>
            </div>
            <div class="step" id="first-run">
                <div class="step-title"><span class="step-num">2</span>Start n8n</div>
                <div class="step-body">
                    <div class="code-block">
                        <span class="code-lang">bash</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                        <pre>cd ~/n8n && docker compose up -d && docker compose logs -f n8n</pre>
                    </div>
                    <div class="callout callout-success">
                        <i data-feather="check-circle" class="callout-icon" style="width:16px;height:16px;color:var(--success);"></i>
                        <span>Open <a href="http://localhost:5678" target="_blank"><strong>http://localhost:5678</strong></a> — n8n's setup wizard will greet you on first launch.</span>
                    </div>
                </div>
            </div>
            <div class="step">
                <div class="step-title"><span class="step-num">3</span>Start / Stop n8n</div>
                <div class="step-body">
                    <div class="code-block">
                        <span class="code-lang">bash</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                        <pre># Stop
docker compose -f ~/n8n/docker-compose.yml down

# Start
docker compose -f ~/n8n/docker-compose.yml up -d</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div><!-- /panel-mac -->

<!-- ══════════════════════════════════ POST-INSTALL (common) -->
<div class="divider"></div>

<div class="section" id="post-install">
    <div class="section-header">
        <div class="section-icon" style="background:linear-gradient(135deg,#10b981,#4f46e5);">
            <i data-feather="star" style="width:22px;height:22px;color:#fff;"></i>
        </div>
        <div>
            <h2>Post-Install Configuration</h2>
            <p>Applies to all environments</p>
        </div>
    </div>
    <div class="steps">
        <div class="step">
            <div class="step-title"><span class="step-num">1</span>Create your owner account</div>
            <div class="step-body">
                <p>On first visit, n8n shows a setup screen asking for your email and password. This creates the owner account — use a strong password. You cannot use n8n without completing this step.</p>
            </div>
        </div>
        <div class="step">
            <div class="step-title"><span class="step-num">2</span>Set Timezone</div>
            <div class="step-body">
                <p>The <code>GENERIC_TIMEZONE=UTC</code> setting controls when scheduled workflows run. Change it in the <code>docker-compose.yml</code> if needed (e.g. <code>Europe/London</code>, <code>America/New_York</code>), then restart with <code>docker compose up -d</code>.</p>
            </div>
        </div>
        <div class="step">
            <div class="step-title"><span class="step-num">3</span>Connect to Arrissa Data API</div>
            <div class="step-body">
                <p>To call your Arrissa Data API from n8n workflows, use the <strong>HTTP Request</strong> node:</p>
                <ul style="margin:8px 0 0 16px;list-style:disc;line-height:2.2;">
                    <li>Method: <code>GET</code></li>
                    <li>URL: <code id="api-url-txt">http://127.0.0.1/market-data-api-v1/market-data-api.php</code></li>
                    <li>Add header: <code>X-API-Key</code> → your API key from Arrissa Data API Settings</li>
                </ul>
                <div class="callout callout-info" style="margin-top:12px;">
                    <i data-feather="info" class="callout-icon" style="width:16px;height:16px;color:var(--accent);"></i>
                    <span>If n8n and the Arrissa Data API are both running locally (same machine), you can use <code>http://host.docker.internal</code> instead of <code>localhost</code> to reach services outside Docker.</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ══════════════════════════════════ UPDATING -->
<div class="divider"></div>

<div class="section" id="updating">
    <div class="section-header">
        <div class="section-icon" style="background:linear-gradient(135deg,#0ea5e9,#6366f1);">
            <i data-feather="refresh-cw" style="width:22px;height:22px;color:#fff;"></i>
        </div>
        <div>
            <h2>Updating n8n</h2>
            <p>Always backup your data before updating</p>
        </div>
    </div>
    <div class="steps">
        <div class="step">
            <div class="step-title"><span class="step-num">1</span>Ubuntu VPS update</div>
            <div class="step-body">
                <div class="code-block">
                    <span class="code-lang">bash</span>
                    <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                    <pre>cd /opt/n8n
docker compose pull
docker compose up -d</pre>
                </div>
                <p>This pulls the latest n8n image and recreates the container. Your data in the <code>n8n_data</code> volume is preserved.</p>
            </div>
        </div>
        <div class="step">
            <div class="step-title"><span class="step-num">2</span>Windows update</div>
            <div class="step-body">
                <div class="code-block">
                    <span class="code-lang">powershell</span>
                    <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                    <pre>Set-Location "$env:USERPROFILE\n8n"
docker compose pull
docker compose up -d</pre>
                </div>
            </div>
        </div>
        <div class="step">
            <div class="step-title"><span class="step-num">3</span>macOS update</div>
            <div class="step-body">
                <div class="code-block">
                    <span class="code-lang">bash</span>
                    <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                    <pre>cd ~/n8n && docker compose pull && docker compose up -d</pre>
                </div>
            </div>
        </div>
        <div class="step">
            <div class="step-title"><span class="step-num">4</span>Backup your workflows first</div>
            <div class="step-body">
                <p>In the n8n UI: <strong>Settings → n8n API</strong> to enable the API, then export all workflows via <strong>Workflows → ⋯ menu → Export</strong>, or use the CLI:</p>
                <div class="code-block">
                    <span class="code-lang">bash</span>
                    <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                    <pre>docker exec n8n n8n export:workflow --all --output=/home/node/.n8n/backup.json</pre>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ══════════════════════════════════ TROUBLESHOOTING -->
<div class="divider"></div>

<div class="section" id="troubleshooting">
    <div class="section-header">
        <div class="section-icon" style="background:linear-gradient(135deg,#ef4444,#f59e0b);">
            <i data-feather="alert-triangle" style="width:22px;height:22px;color:#fff;"></i>
        </div>
        <div>
            <h2>Troubleshooting</h2>
            <p>Common problems and fixes</p>
        </div>
    </div>
    <div class="steps">
        <div class="step">
            <div class="step-title"><span class="step-num">!</span>Can't reach n8n after Caddy setup</div>
            <div class="step-body">
                <p>Check DNS has propagated: <code>dig +short <span id="u-dig">n8n.yourdomain.com</span> A</code> should return your server IP. Also check Caddy logs:</p>
                <div class="code-block">
                    <span class="code-lang">bash</span>
                    <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                    <pre>sudo journalctl -u caddy --no-pager -n 50</pre>
                </div>
            </div>
        </div>
        <div class="step">
            <div class="step-title"><span class="step-num">!</span>Webhooks not receiving data (VPS)</div>
            <div class="step-body">
                <p>Make sure <code>WEBHOOK_URL</code> in your <code>docker-compose.yml</code> matches the public URL exactly, including the trailing slash: <code class="hl-domain" id="u-webhook-txt">https://n8n.yourdomain.com/</code>. Restart after changing:</p>
                <div class="code-block">
                    <span class="code-lang">bash</span>
                    <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                    <pre>cd /opt/n8n && docker compose up -d --force-recreate</pre>
                </div>
            </div>
        </div>
        <div class="step">
            <div class="step-title"><span class="step-num">!</span>"Invalid cookie" / can't log in on local</div>
            <div class="step-body">
                <p>Ensure <code>N8N_SECURE_COOKIE=false</code> is set in your <code>docker-compose.yml</code> for local HTTP setups. If you previously used <code>true</code>, clear browser cookies for localhost and restart the container.</p>
            </div>
        </div>
        <div class="step">
            <div class="step-title"><span class="step-num">!</span>Port 5678 already in use</div>
            <div class="step-body">
                <div class="code-block">
                    <span class="code-lang">bash / powershell</span>
                    <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                    <pre># Linux/macOS
sudo lsof -i :5678

# Windows
netstat -ano | findstr :5678</pre>
                </div>
                <p>Stop whatever is using the port, or change n8n's port in <code>docker-compose.yml</code> (e.g. <code>"5679:5678"</code>) and update Caddy to match.</p>
            </div>
        </div>
        <div class="step">
            <div class="step-title"><span class="step-num">!</span>Docker Desktop not starting on Windows</div>
            <div class="step-body">
                <p>Ensure WSL 2 is installed and set as default:</p>
                <div class="code-block">
                    <span class="code-lang">powershell</span>
                    <button class="copy-btn" onclick="copyCode(this)"><i data-feather="copy" style="width:11px;height:11px;"></i> Copy</button>
                    <pre>wsl --install
wsl --set-default-version 2</pre>
                </div>
                <p>Then restart your PC and re-open Docker Desktop.</p>
            </div>
        </div>
    </div>
</div>

<!-- ══════════════════════════════════ RELATED GUIDES -->
<div class="divider"></div>

<div class="section" id="related">
    <h2 style="font-size:1.3rem;font-weight:700;margin:0 0 20px;">Related Guides</h2>
    <a href="/get/"" class="guide-card">
        <div class="guide-card-icon" style="background:linear-gradient(135deg,#4f46e5,#6366f1);">
            <i data-feather="server" style="width:22px;height:22px;color:#fff;"></i>
        </div>
        <div class="guide-card-text">
            <h3>Arrissa Data API &mdash; Installation Guide</h3>
            <p>Set up the API server on Ubuntu + Caddy, Windows VPS + XAMPP, or Windows localhost + WAMP.</p>
        </div>
        <i data-feather="arrow-right" style="width:18px;height:18px;color:var(--text-secondary);margin-left:auto;flex-shrink:0;"></i>
    </a>
    <a href="/get/brokers.html"" class="guide-card">
        <div class="guide-card-icon" style="background:linear-gradient(135deg,#10b981,#059669);">
            <i data-feather="trending-up" style="width:22px;height:22px;color:#fff;"></i>
        </div>
        <div class="guide-card-text">
            <h3>Recommended Brokers</h3>
            <p>6 partner brokers trusted for use with Arrissa Data APIs and MetaTrader 5.</p>
        </div>
        <i data-feather="arrow-right" style="width:18px;height:18px;color:var(--text-secondary);margin-left:auto;flex-shrink:0;"></i>
    </a>
    <a href="/get/vps-providers.html"" class="guide-card">
        <div class="guide-card-icon" style="background:linear-gradient(135deg,#0ea5e9,#4f46e5);">
            <i data-feather="cloud" style="width:22px;height:22px;color:#fff;"></i>
        </div>
        <div class="guide-card-text">
            <h3>VPS Providers</h3>
            <p>Recommended hosting including Cloud.co.za to run your API and n8n 24/7.</p>
        </div>
        <i data-feather="arrow-right" style="width:18px;height:18px;color:var(--text-secondary);margin-left:auto;flex-shrink:0;"></i>
    </a>
</div>

        </div><!-- /main-content -->
    </div><!-- /page-layout -->
</div><!-- /container -->

<footer>
    <p>Arrissa Data API — <a href="https://arrissa.trade" target="_blank">arrissa.trade</a> · n8n is an open-source workflow automation tool by <a href="https://n8n.io" target="_blank">n8n.io</a></p>
</footer>

<script>
feather.replace();

function getDomain() { return document.getElementById('domainInput').value.trim() || 'n8n.yourdomain.com'; }
function getIP()     { return document.getElementById('ipInput').value.trim() || 'YOUR_SERVER_IP'; }
function getUser()   { return document.getElementById('userInput').value.trim() || 'ubuntu'; }

function updateAll() {
    const domain = getDomain();
    const ip     = getIP();
    const user   = getUser();
    const proto  = 'https';

    // SSH command
    setCode('u-ssh', () => `ssh ${user}@${ip}`);

    // Prerequisites text
    setText('u-domain-txt', domain);
    setText('u-ip-txt', ip);

    // docker-compose.yml
    setCode('u-compose', el => el.textContent
        .replace(/N8N_HOST=.+/g, `N8N_HOST=${domain}`)
        .replace(/WEBHOOK_URL=.+/g, `WEBHOOK_URL=${proto}://${domain}/`)
    );

    // Caddyfile
    setCode('u-caddy', el => el.textContent.replace(/n8n\.yourdomain\.com/g, domain));

    // n8n URL
    const url = `${proto}://${domain}`;
    const urlEl = document.getElementById('u-n8n-url');
    if (urlEl) { urlEl.textContent = url; urlEl.href = url; }

    // Dig
    setText('u-dig', domain);
    setText('u-webhook-txt', `${proto}://${domain}/`);

    // Post-install API URL
    const isLocal = !['ubuntu'].includes(activeEnv());
    setText('api-url-txt', isLocal
        ? 'http://host.docker.internal/market-data-api-v1/market-data-api.php'
        : `https://${document.getElementById('domainInput').value.trim() || 'yourarrissadomain.com'}/market-data-api-v1/market-data-api.php`
    );
}

function setText(id, val) { const el = document.getElementById(id); if (el) el.textContent = val; }
function setCode(id, fn)  { const el = document.getElementById(id); if (el) el.textContent = fn(el); }

let _activeEnv = 'ubuntu';
function activeEnv() { return _activeEnv; }

function switchEnv(env) {
    _activeEnv = env;
    document.querySelectorAll('.env-tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.env-panel').forEach(p => p.classList.remove('active'));
    const tab = document.querySelector(`.env-tab[onclick="switchEnv('${env}')"]`);
    if (tab) tab.classList.add('active');
    const panel = document.getElementById(`panel-${env}`);
    if (panel) panel.classList.add('active');
    updateAll();
}

function copyCode(btn) {
    const pre = btn.closest('.code-block').querySelector('pre');
    navigator.clipboard.writeText(pre.textContent).then(() => {
        btn.classList.add('copied');
        btn.innerHTML = '<i data-feather="check" style="width:11px;height:11px;"></i> Copied!';
        feather.replace();
        setTimeout(() => {
            btn.classList.remove('copied');
            btn.innerHTML = '<i data-feather="copy" style="width:11px;height:11px;"></i> Copy';
            feather.replace();
        }, 2000);
    });
}

document.querySelectorAll('a[href^="#"]').forEach(a => {
    a.addEventListener('click', e => {
        const t = document.querySelector(a.getAttribute('href'));
        if (t) { e.preventDefault(); t.scrollIntoView({ behavior: 'smooth', block: 'start' }); }
    });
});

updateAll();
</script>
</body>
</html>
